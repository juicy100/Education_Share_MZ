# 💎 스프링 부트 기초(교육 5회차_230421) {#top}
> created : 2023-04-21
> 
> updated : 2023-04-21
> 
> author : 백민주
##
***
## 🔶 목차
1. [강의 Background](#-강의-background)
2. [Maven에서의 JPA 사용](#-maven에서의-jpa-사용)
    - [조회](#-조회) / [수정](#-수정) / [삭제](#-삭제)
3. [Springboot에서의 JPA 사용](#-spring-boot에서의-jpa-사용)
***
## 🔶 강의 Background
- [수업메모](https://gist.github.com/carami/d3bb434cacf371d44e71538b93e6c212)
***
## 🔶 Maven에서의 JPA 사용
#### 🔹 조회
```java
// 조회
   Product findProduct = em.find(Product.class, 1L);
   Product findProduct2 = em.find(Product.class, 1L);
   if (findProduct == findProduct2) System.out.println("같은 인스턴스입니다."); //같은 인스턴스임
```
#### 🔹 수정
```java
// 수정(조회 후 수정)
   Product findProduct = em.find(Product.class, 1L);
   findProduct.setName("pen");
   findProduct.setPrice(5000);
```
#### 🔹 삭제
```java
// 삭제(조회 후 삭제)
   Product findProduct = em.find(Product.class, 1L);
   em.remove(findProduct);

   System.out.println("persist() 수행후!!");
   tx.commit(); //commit까지 해야 DB에 반영 완료
   System.out.println("commit  수행 후!!");
```
***
## 🔶 Spring boot에서의 JPA 사용
- 프로젝트 설정 시 추가파일
  - Spring Boot DevTools, Lombok, Spring Web, Spring Data JPA, Thymeleaf, H2 Database
    - Spring Data JPA : Spring에서 JPA를 더 쉽게 쓰게 해줌
#### 🔹 Annotation 활용하여 Entity 만들기
```java
package com.example.todo.domain;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

import lombok.Getter;
import lombok.Setter;
import lombok.ToString;

@Entity
@Table(name = "todos")
@Getter
@Setter
@ToString
public class Todo {

    @Id
    @GeneratedValue
    private Long id;
    @Column(name="todo_sample", unique=true, length=50)
    private String todo;
    private boolean done;
}
```
#### 🔹 환경 설정
- **`application.properties`는 오타 체크를 못해서 `application.yml`으로 파일명 Rename 필요**
  - application.properties : springboot에서 최소한의 설정에 대한 값을 알려주면 실행을 알아서 해주는 파일
- Datasource : JDBC 설정
- JPA : DB 설정(수업에서는 hibernate로 설정)
#### 🔹 Spring Data JPA 쓰는 방법
```java
package com.example.todo.repository;

import org.springframework.data.jpa.repository.JpaRepository;

import com.example.todo.domain.Product;

public interface ProductRepository extends JpaRepository<Product, Long> { 
    //JpaRepository라는 interface에게 1) 어떤 Entity를 사용할 건지
    //2) 그 Entity의 key의 type이 뭔지만 알려주면 나머지는 알아서 다 구현해줌
}
```
#### 🔹 JPA 테스트해보기
- **src/test/java에서 해야함**
- 메소드 단위로 해야하니까 주석처리 없이 간편하게 테스트 가능
  ```java
  package com.example.todo.repository;

  import java.util.Optional;

  import org.junit.jupiter.api.Test;
  import org.springframework.beans.factory.annotation.Autowired;
  import org.springframework.boot.test.context.SpringBootTest;

  import com.example.todo.domain.Product;

  @SpringBootTest
  public class ProductRepositoryTest {

    @Autowired
    ProductRepository productRepository;

    @Test // Table에 Add Test
    void addProduct() throws Exception {
        Product p = new Product();
        p.setName("커피");
        p.setPrice(5000);
        try {
            productRepository.save(p); // Repository에 save를 해줌
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test // Add한 Entity 갖고오기
    void getProduct() {
        Optional<Product> findProduct = productRepository.findById(34L);
        System.out.println(findProduct);
    }
  }
  ```
***
[맨 위로 가기](#top)
