# ğŸ’ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ê¸°ì´ˆ (êµìœ¡ 3íšŒì°¨_230417) {#top}
> created : 2023-04-17
> 
> updated : 2023-04-18
> 
> author : ë°±ë¯¼ì£¼
##
***
## ğŸ”¶ ëª©ì°¨
1. [ê°•ì˜ Background](#-ê°•ì˜-background)
2. [Annotation](#-annotation)
3. [Spring Boot ì„¤ì¹˜](#-springboot-ì„¤ì¹˜)
4. [Springboot ê¸°ì´ˆ í”„ë¡œê·¸ë˜ë°](#-springboot-ê¸°ì´ˆ-í”„ë¡œê·¸ë˜ë°)
5. [ì½”ì–´ê¸°ìˆ  1 - IoC](#-ì½”ì–´ê¸°ìˆ -1-ioc-ì œì–´ì˜-ì—­ì „)
6. [ì½”ì–´ê¸°ìˆ  2 - AoP](#-ì½”ì–´ê¸°ìˆ -2-aop)
7. [Spring êµ¬ì¡° ì‹¤ìŠµ](#-spring-êµ¬ì¡°-ì‹¤ìŠµ)
    - [êµ¬í˜„ë°©ë²• 1. xml í†µí•œ IoC](#êµ¬í˜„-ë°©ë²•-1-xmlì„-í†µí•´-iocë¥¼-í•˜ëŠ”-ë°©ë²•)
    - [êµ¬í˜„ë°©ë²• 2. Config í†µí•œ IoC](#êµ¬í˜„-ë°©ë²•-2-configë¥¼-í†µí•´-iocë¥¼-í•˜ëŠ”-ë°©ë²•)
    - [êµ¬í˜„ë°©ë²• 3. Annotation í†µí•œ IoC](#êµ¬í˜„-ë°©ë²•-3-bean-ë“±ë¡ì´-ì•„ë‹ˆë¼-annotationì„-í†µí•´-ì§ì ‘-iocí•˜ëŠ”-ë°©ë²•---componentê°€-ë©”ì¸)
8. [ìë°”ê¸°ì´ˆ](#-ìë°”-ê¸°ì´ˆ)
9. [ê°•ì˜ìš”ì•½](https://github.com/juicy100/work_2023/blob/main/01_%EC%88%98%EC%8A%B5/03_%EC%9E%90%EB%B0%94%EA%B5%90%EC%9C%A1(23.4.10-23.4.28)/230418_Day4_%EC%8A%A4%ED%94%84%EB%A7%81%20%EB%B6%80%ED%8A%B8%20%EA%B8%B0%EC%B4%88.md#-review)
***
## ğŸ”¶ ê°•ì˜ Background
- **[ìˆ˜ì—…ë©”ëª¨](https://gist.github.com/carami/f924bbbca225e9443b25479c477bf6e6)**
***
## ğŸ”¶ Annotation
- Class ìƒì„±í•  ë•Œ `@interface`ê°€ Annotationì„
- Class ìœ„ì— `@Retention(RetentionPolicy.`ì„ ì¹˜ë©´ `RUNTIME`, `CLASS`, `SOURECE` ì˜µì…˜ì´ ëœ¸
- Annotation : **í‘œì‹ì„ ë‚˜íƒ€ë‚´ëŠ”** `@`, í•„ìš”í•œ ì§€ì ì— ë¶™ì´ë©´ ì‹¤í–‰ê°€ëŠ¥
  - ì‹¤í–‰ë°©ë²•
    ```
    Method method = hello.getClass().getDeclaredMethod("hello");
            if (method.isAnnotationPresent(Count100.class)) {
                for (int i = 0; i < 100; i++) {
                    hello.hello();
                }
            } else
                hello.hello();
    ```
  - **Annotation ì „ì‹ ì„ ë§Œë“¤ì–´ë†“ìœ¼ë©´ ì„ ì–¸í•´ë†“ì€ ë³€ìˆ˜ ì‚¬ìš©í•´ì„œ class êµ¬ì„± ê°€ëŠ¥**
    - Annotation ì „ì‹ 
      ```
      package com.examples.day03;

      import java.lang.annotation.ElementType;
      import java.lang.annotation.Retention;
      import java.lang.annotation.RetentionPolicy;
      import java.lang.annotation.Target;

      @Retention(RetentionPolicy.RUNTIME)
      @Target(ElementType.METHOD)
      public @interface PrintAnnotation {
          String value() default "@";
          int number() default 5;
      }
      ```
    - Annotation ì „ì‹ ì„ í™œìš©í•œ class
      ```
      @PrintAnnotation
       public void method1(){
          System.out.println("Method1 ì‹¤í–‰!!");
       }

      @PrintAnnotation("*")
       public void method2(){
          System.out.println("Method2 ì‹¤í–‰!!");
       }

      @PrintAnnotation(value = "&", number = 20)
      public void method3(){
        System.out.println("Method3 ì‹¤í–‰!!");
      }
      ```
***
## ğŸ”¶ Springboot ì„¤ì¹˜
- [ì„¤ì¹˜ ë°©ë²• 1 : ì›¹ í†µí•´ì„œ ì„¤ì¹˜](https://start.spring.io/)
  - Project
    - Maven : Maven Repositoryì—ì„œ ì§€ì •ëœ XML í˜•ì‹ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•Œì•„ì„œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹, ë²„ì „ ê´€ë¦¬ì˜ ì–´ë ¤ì›€ì„ í•´ì†Œ
    - Gradle : Maven Repositoryì— ìˆëŠ” ì• ë“¤ì„ ì½ì–´ì˜¤ëŠ”ë°, ì¢€ ë” ì‰½ê²Œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹, Spring Bootì—ì„œëŠ” ëŒ€ë¶€ë¶„ Gradleì„ 
      - ì–¸ì–´ íƒ€ì… 1) Groovy
      - ì–¸ì–´ íƒ€ì… 2) Kotlin
  - Spring Boot ë²„ì „ : ìµœê·¼ì—” 2.7.10ì„ ë§ì´ ì‚¬ìš©
  - Project Metadata
    - Group : íŒ¨í‚¤ì§€ëª…
    - Packaging : Jar - Tomcat(ì„œë²„)ì„ ëª¨ë‘ í¬í•¨í•´ì„œ ì‹¤í–‰ì‹œí‚¤ëŠ” ë°©ì‹ / War - ì„œë²„ ì œì™¸í•˜ê³  ì‹¤í–‰ì‹œí‚¤ëŠ” ë°©ì‹
  - Java ë²„ì „ : ì‹¤ìŠµì—ì„œëŠ” 11ì„ ì‚¬ìš© ì¤‘
  - Depedencies : IDEì— ì¶”ê°€ë¡œ ê°œë°œí•  ìˆ˜ ìˆëŠ” ì„¤ì •(= Eclipsì˜ STS = Visual Studioì˜ í™•ì¥íŒ©)
- **ì„¤ì¹˜ ë°©ë²• 2 : VSCODEì—ì„œ Extensionì—ì„œ `Spring Boot Extension Pack` ì„¤ì¹˜**
  - ê°€. í”„ë¡œì íŠ¸ ì‹œì‘ : `Ctrl + Shift + P` ëˆŒëŸ¬ì„œ `Spring Initializr` ì…ë ¥í•´ì„œ `Create a Gradle Project...` ìƒì„±
  - ë‚˜. ì¶”ê°€ í™•ì¥íŒ© : Spring Boot DevTools(Saveí•˜ë©´ ìë™ ì»´íŒŒì¼í•˜ê²Œ ì§€ì›), Spring Web, lombok ì¶”ê°€
    - Lombokì€ ì½”ë“œë¥¼ ì¡°ê¸ˆ ë” Annotationì„ ì´ìš©í•´ì„œ ì‰½ê²Œ ì“¸ ìˆ˜ ìˆê²Œ ì œê³µ(ì´ê²Œ ì—†ìœ¼ë©´ ì½”ë“œì— ìˆë‹¤ê³  ìƒê°í•˜ë©´ ë¨)
      ```
      import lombok.Data;
      import lombok.Getter;
      import lombok.Setter;
      import lombok.ToString;

      @Setter
      @ToString
      @Getter
      @Data
      public class MyBean {
      }
      ```
  - ë‹¤. ì¶”ê°€ Package ì„¤ì¹˜ : Gradle for Javaì— ì„¤ì¹˜
  - ë¼. build.gradle íŒŒì¼ í™•ì¸
    - dependenciesì—ì„œ `starter`ë¼ê³  ìˆëŠ” ì• ë“¤ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ëŠ”ë° í•„ìš”í•œ ëª¨ë“  ìš”ì†Œë¥¼ ê°€ì ¸ì˜´(spring boot ì§€ì› ê¸°ëŠ¥)
  - ë§ˆ. íŒŒì¼ êµ¬ì¡° í™•ì¸
    - ê¸°ë³¸ì ìœ¼ë¡œ main / testê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ ë‚˜ëˆ ì ¸ ìˆìŒ
    - staticì—ëŠ” ì •ì ìœ¼ë¡œ í•„ìš”í•œ ìš”ì†Œë§Œ ë„£ê¸°
    - `application.properties` ì— ë‚´ê°€ í•„ìš”í•œ ì„¤ì •ì„ ì¶”ê°€í•´ì¤Œ **(spring bootì„¤ì •ë³´ë‹¤ ìš°ì„ ì„)**
      - properties í™•ì¥ìë¥¼ `yml`ë¡œ ë³€ê²½í•´ì„œ ì‚¬ìš© â†’ properties ë¶€ì¡±í•œ ë¶€ë¶„ì„ ymlì—ì„œ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
  - ë°”. ê¸°ë³¸ì ìœ¼ë¡œ ìˆëŠ” main > java > `.java` íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´
    - **`Tomcat initialized with port(s): 8080 (http)`ë¼ê³  8080 í¬íŠ¸ì˜ ì„œë²„ê°€ ì˜¤í”ˆ**ë˜ì—ˆìŒì„ ì•Œë ¤ì¤Œ
    - ê·¸ëŸ¬ë©´ [http://localhost:8080/](http://localhost:8080/)ì—ì„œ ì‹¤í–‰ê°€ëŠ¥
***
## ğŸ”¶ Springboot ê¸°ì´ˆ í”„ë¡œê·¸ë˜ë°
- **@RestController** : Annotation ì´ìš©í•´ì„œ URL ê¸°ë°˜ì˜ Web í”„ë¡œê·¸ë˜ë°(ë‚´ë¶€ì ì¸ê±´ springì—ì„œ ì•Œì•„ì„œ í•´ì¤Œ)
```
@RestController
public class HelloController {
    @GetMapping("/")
    public String hello() {
        return "hello~~!! spring boot ^^";
    }
    // ì‹¤í–‰ URL : http://localhost:8080/

    @GetMapping("/hi")
    public String hi(String name) {
        return "hi!!!" + name;
    }
    // ì‹¤í–‰ URL : http://localhost:8080/hi?name=carami
}
```
- Spring Frameworkì˜ ê°€ì¥ í° íŠ¹ì§•
  - **í•„ìš”í•œ ìš”ì†Œë¥¼ ê°€ì ¸ì™€ì„œ ì“¸ ìˆ˜ ìˆë‹¤**
  - **`Spring Core`ì„ í•­ìƒ ê¸°ì €**ì— ê¹”ê³  ìˆë‹¤ â†’ **IoC, AOP**ì™€ ê´€ë ¨
  - Spring FrameworkëŠ” IoCë¼ëŠ” ê¸°ëŠ¥ì„ í•­ìƒ ì“°ê³  ìˆìŒ
- terminalì— `.\gradlew.bat dependencies`ì„ ì…ë ¥í•´ì„œ spring frameworkì˜ êµ¬ì¡°ë¥¼ ë³¼ ìˆ˜ ìˆìŒ
***
## ğŸ”¶ ì½”ì–´ê¸°ìˆ  1. IoC (ì œì–´ì˜ ì—­ì „)
- **Spring BootëŠ” IoCê¸°ë°˜ì˜ í”„ë¡œê·¸ë˜ë°ì„!!**
- **IoC(Inversion of Control)ë€? ê°ì²´(bean)ì˜ ìƒì„±ë¶€í„° ì†Œë©¸ê¹Œì§€ì˜ ëª¨ë“  lifecycleì„ Containerê°€ ê´€ë¦¬í•˜ê² ë‹¤(=ì»¨í…Œì´ë„ˆê°€ ì•Œì•„ì„œ ê°ì²´ë¥¼ ìƒì„±)**
  - "ê°ì²´ì˜ ìƒì„±ì„ í”„ë ˆì„ì›Œí¬ê°€ ì•Œì•„ì„œ í•´ì£¼ê² ë‹¤"ì˜ ì˜ë¯¸ë¡œ ì‚¬ìš© â†’ í”„ë¡œê·¸ë˜ë¨¸ëŠ” ê°ì²´ì— ëª‡ê°€ì§€ ìš”ì†Œ ì§€ì • í•„ìš”(=**DI(ì˜ì¡´ì„± ì£¼ì…)**)
  - ê°ì²´ì˜ ì œì–´ë¥¼ ë‚´ê°€ í•˜ëŠ”ê²Œ ì•„ë‹ˆê°€ ì»¨í…Œì´ë„ˆê°€ í•œë‹¤ëŠ” ì˜ë¯¸ì—ì„œ "ì œì–´ì˜ ì—­ì „"
- êµ¬ì¡°
```mermaid
graph LR;
A[client]-->B[Presentation Layer_Controller]
B-->C[Service Layer_Service]
C-->D[Data Layer_DAO]
D-->E[DB];
```
  - Data Layer(DAO)ì—ì„œëŠ” Data ì…ì¶œë ¥ë§Œ í•˜ëŠ”ê±°ì„
  - Data Layerë¥¼ ê³ ì¹˜ë©´ Service Layoutì„ ë‹¤ ê³ ì¹˜ê²Œ ë˜ë©´ **ê²°í•©ë„ê°€ ë†’ë‹¤**ê³  í‘œí˜„í•¨ â†’ ì´ë¥¼ í•´ì†Œí•˜ë ¤ë©´ **Interface**ë¥¼ ë§Œë“¤ì–´ì•¼í•¨
  - í˜¹ì€ Factoryë¥¼ ì‚¬ìš©í•˜ì—¬ Service Layerê°€ factoryì— ìš”ì²­í•˜ì—¬ Data Layerë¥¼ ê°€ì ¸ì˜´
#### ì½”ë“œë¥¼ ì´ìš©í•´ì„œ IoCë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•
- Factory
  - BeanFactory : AOP ì§€ì› ì•ˆí•¨, `import org.springframework.context.annotation.Bean;`ì— ìˆëŠ” ìì²´ íŒ©í† ë¦¬ ê¸°ëŠ¥
    - Beanì„ ìƒì„±í•  ë•Œ Springì€ Singleton í˜•íƒœë¡œ ë§Œë“¤ì–´ì¤Œ(ê·¸ë˜ì„œ í•˜ë‚˜ë§Œ ë§Œë“¤ì–´ë†“ê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ê°–ê³ ì™€ì„œ ì‚¬ìš©)
      - ë§Œì•½ì— ë‹¤ë¥¸ í˜•íƒœë¡œ ë§Œë“¤ì–´ì£¼ë ¤ë©´ `@Scope("prototype")` ì´ë ‡ê²Œ ì§€ì •í•´ì¤˜ì•¼í•¨(defaultëŠ” singleton)
      - í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ ì§€ì •ë˜ì–´ìˆëŠ” ê²½ìš°ëŠ” ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ë§¤ë²ˆ ìƒì„±í•´ì„œ ë§Œë“¤ì–´ì¤Œ
      - dependency Look up ë°©ì‹ : `MyBean bean = (MyBean) context.getBean("myBean");`
      - dependency Injection ë°©ì‹
        - ìƒì„±ì ê¸°ë°˜ ì£¼ì… ë°©ì‹
        ```
          @Bean
          public Dice dice(){ //ìƒì„±ì ê¸°ë°˜ ì£¼ì…ë°©ì‹, ìƒì„±ìê°€ ë§ˆë ¨ë˜ì–´ìˆì–´ì•¼í•œë‹¤
            return new Dice(6);
          }
        ```
        - ì„¤ì •ì ê¸°ë°˜ ì£¼ì… ë°©ì‹
        ```
          @Bean
          public Player kang(Dice dice){ //ì„¤ì •ì ê¸°ë°˜ ì£¼ì…ë°©ì‹, Setter Methodë¥¼ í†µí•´ ì£¼ì…í•´ì•¼í•œë‹¤
            Player p = new Player();
            p.setName("ê°•ê²½ë¯¸");
            p.setDice(dice);
            return p;
          }
        ```
        - í•„ë“œë¥¼ í†µí•œ ì£¼ì… ë°©ì‹ : `@Autowired` ì‚¬ìš©
          - Spring Frameworkì— ì¢…ì†ì´ ëœë‹¤ëŠ” ë‹¨ì ì´ ìˆìŒ, ê·¸ë˜ì„œ ì„¤ì •ìë‚˜ ìƒì„±ìë¥¼ í†µí•œ ì£¼ì… ë°©ì‹ì„ ì¢€ ë” ì¢‹ë‹¤ê³  ê°œë°œìë“¤ì´ ìƒê°í•¨
  - ApplicationFactory : AOP ì§€ì›í•¨
  ```
  ApplicationContext context = new AnnotationConfigApplicationContext(Configëª….class);
  ```
#### Annotationì„ ì´ìš©í•´ì„œ IoCë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•
- `@ComponentScan(ìŠ¤ìº”í•  ë‚´ìš©)`
  - ì˜ˆì‹œ: `@ComponentScan(basePackages = "sample")` - íŒ¨í‚¤ì§€ì— ìˆëŠ” ê±¸ ì½ì–´ì™€ë‹¬ë¼ëŠ” ì˜ë¯¸
- `@Component` : Componentë¡œ ì„¤ì •

***
## ğŸ”¶ ì½”ì–´ê¸°ìˆ  2. AoP
### ë‹¤ìŒì‹œê°„ì— ê°•ì˜ ì˜ˆì •
***
## ğŸ”¶ Spring êµ¬ì¡° ì‹¤ìŠµ
- êµ¬ì¡°
```mermaid
graph LR;
A[UserController]-->B[UserService_Interface]
C[UserSerivceImpl]-->B
C-->D[UserDAO_Interface]
E[UserDAOImpl]-->D;
```
#### êµ¬í˜„ ë°©ë²• 1. xmlì„ í†µí•´ IoCë¥¼ í•˜ëŠ” ë°©ë²•
- Data Sourceë¥¼ ì ‘ê·¼í• ë•ŒëŠ” Beanì„ í†µí•´ IoCë¥¼ í•˜ëŠ” ê²Œ ë§ìŒ
#### êµ¬í˜„ ë°©ë²• 2. Configë¥¼ í†µí•´ IoCë¥¼ í•˜ëŠ” ë°©ë²•
- `implements CommandLineRunner` : CommandRunnerì— êµ¬í˜„ë˜ì–´ ìˆëŠ”ê±¸ ìë™ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ì—­í• (Runí•¨ìˆ˜ ìƒì„±ë¨)
- `@Configuration` : Configurationìœ¼ë¡œ ë“±ë¡
```
@Configuration
public class UserConfig {

    @Bean
    public userDao userDao() {
        return new UserDaoImpl();
    }

    @Bean
    public UserService userService(userDao userDao) {
        return new UserServiceImpl(userDao);
    }

    @Bean
    public UserController userController(UserService userService) {
        return new UserController(userService);
    }

}
```
- `@Qualifier("userCaramelDao")` : ì—¬ëŸ¬ê°œ ì¤‘ì—ì„œ IDê°€ "xxx"ì¸ ì• ë¥¼ ê³¨ë¼ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•¨
#### êµ¬í˜„ ë°©ë²• 3. Bean ë“±ë¡ì´ ì•„ë‹ˆë¼ Annotationì„ í†µí•´ ì§ì ‘ IoCí•˜ëŠ” ë°©ë²• - @Componentê°€ ë©”ì¸
-  `@Repository` : Componentë¥¼ ìƒì† ë°›ê³  ìˆê³ , Componentì™€ ë™ì¼í•˜ê²Œ ì“¸ ìˆ˜ ìˆìŒ - **DAOì—ì„œ ì‚¬ìš©í•¨** / Dataì™€ ê´€ë ¨ëœ ê²ƒ
-  `@Service` : Serviceì—ì„œ ì‚¬ìš© / businessì™€ ê´€ë ¨ëœ ê²ƒ
-  `@Controller` : Controllerì—ì„œ ì‚¬ìš©
-  `@Configuration` : Configì—ì„œ ì‚¬ìš©
- **`@ComponentScan(basePackages = "com.example.iocexam")` : basePackageëŠ” main ìˆëŠ” ì‹¤í–‰ êµ¬ë¬¸ì—ì„œ ì‚¬ìš©**

***
## ğŸ”¶ ìë°” ê¸°ì´ˆ
- **`Alt + Shift + O` ëˆ„ë¥´ë©´ í•„ìš”í•œ packageë¥¼ ìë™ì ìœ¼ë¡œ import ì‹œì¼œì¤Œ**
***
[ë§¨ ìœ„ë¡œ ê°€ê¸°](#top)
